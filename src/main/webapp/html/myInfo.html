<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Canoe!</title>
<link rel="stylesheet" type="text/css" media="screen" href="../css/bootstrap.min.css" />
<!-- <link rel="stylesheet" type="text/css" media="screen" href="../css/bootstrap.min.Cerulean.css" /> -->
<!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"> -->
<link rel="stylesheet" type="text/css" media="screen" href="../node_modules/jquery-ui-dist/jquery-ui.min.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css">
<style>

.container {
    position:relative;
    min-width: 360px;
}


#register-form {
    margin: auto;
    padding: 10px
}

#register-form label {
    text-align: right;
}
#register-view .form-group.row{
    margin:10px 0px;
}

#register-form-bg {
    margin-top: 20px;
    /* background-color: blue; */
    width: 100%;
    height:200px;
    position: relative;
    /* background-image: url("../img/28_Days_Later_hazard.jpg"); */
    background-size: contain;
}
#register-form-bg h1 {
    text-align: left;
    position: absolute;
    bottom: 0px;
    left: 10%;
}

.modify-hide {
    display: none;
}

</style>
</head>
<body>
    <div class="container">

        <section id="navbar-login"></section>

        <section id="register-view">

            <div id="register-form-bg" class="bg-light">
                <h1>내 정보</h1>
            </div>

            <form id="register-form" class="col-lg-8 col-md-10 col-12">
                <!-- <div class="form-group row">
                    <label for="input-id" class="col-sm-4 col-md-6 col-4 col-form-label">Id</label>
                    <div class="col-sm-8 col-md-6 col-8">
                        <input type="text" class="form-control-plaintext" id="input-id" placeholder="아이디" readonly>
                    </div>
                </div> -->
                <div class="form-group row">
                    <label for="input-email" class="col-sm-4 col-md-6 col-4 col-form-label">Email</label>
                    <div class="col-sm-8 col-md-6 col-8">
                        <input type="email" class="form-control-plaintext" id="input-email" placeholder="" readonly>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="input-name" class="col-sm-4 col-md-6 col-4 col-form-label">Name</label>
                    <div class="col-sm-8 col-md-6 col-8">
                        <input type="text" class="form-control-plaintext" id="input-name" placeholder="이름" readonly>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="input-password" class="col-sm-4 col-md-6 col-4 col-form-label">Password</label>
                    <div class="col-sm-8 col-md-6 col-8">
                        <input type="password" class="form-control-plaintext modify-confirm modify-hide" id="input-password" placeholder="" readonly>
                    </div>
                </div>
                
                <div class="form-group row">
                    <div class="col-sm-4 col-md-6 col-4"></div>
                    <div class="col-sm-8 col-md-6 col-8">
                        <button id="modify-view" type="button" class="btn btn-primary">수정하기</button>
                        <div class="modify-confirm modify-hide">
                            <button id="modify-submit" type="button" class="btn btn-danger">저장</button>
                            <button id="modify-cancel" type="button" class="btn btn-primary">취소</button>
                        </div>
                    </div>
                </div>
            </form>

        </section>
        <!-- <section id="search-bar"></section>
        <section id="travel-list"></section> -->



    </div>
    <!-- container end -->

    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <script src="../node_modules/jquery-ui-dist/jquery-ui.js"></script>
    <script src="../node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="../js/common.js"></script>
    <script>
        'use strict'
        
        //세션 체크 후 비로그인 상태면 main으로 강제이동
        var loginUser; // 세션을 담을 변수
        $.get(
            `${serverApiAddr}/json/auth/sessionCheck`, 
            (result)=>{
                if(result.loginUser) {
                    loginUser = result.loginUser;
                } else {
                    location.href = 'main.html';
                }
        });

        //header 불러오기
        $('#navbar-login').load(`${serverApiAddr}/html/header.html`);
        
        //내 정보 불러오기
        getMyInfo();
        function getMyInfo() {
            $.getJSON(
                `${serverApiAddr}/json/member/myInfo`, 
                (result)=>{
                    console.log(result.member);
                    //$('#input-id').val(result.member.memberId);
                    $('#input-name').val(result.member.memberName);
            });
        }
        
    //수정하기 관련 ------------------------------------------------------------
        //수정 폼 보여주기
        $('#modify-view').click(function() {
            $(this).addClass('modify-hide');
            $('.modify-confirm').removeClass('modify-hide');
            $('#register-form input').prop('readonly', '');
            $('#register-form input').removeClass('form-control-plaintext');
            $('#register-form input').addClass('form-control');
        });
        
        //수정 취소
        $('#modify-cancel').click(function() {
            $('.modify-confirm').addClass('modify-hide');
            $('#modify-view').removeClass('modify-hide');
            $('#register-form input').prop('readonly', true);
            $('#register-form input').addClass('form-control-plaintext');
            $('#register-form input').removeClass('form-control');
            getMyInfo();
        });

        //수정 확인
        $('#modify-submit').click(()=>{
            $.post(
                `${serverApiAddr}/json/member/myInfoModify`,
                {
                    memberId: $('#input-id').val(),
                    memberName: $('#input-name').val(),
                    memberPwd: $('#input-password').val()
                },
                (result)=>{
                    //console.log(result);
                    location.reload();
                }
            );
        });
    
    //수정하기 관련 end ---------------------------------------------------------

    </script>
</body>
</html>
